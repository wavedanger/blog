(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{514:function(t,_,v){t.exports=v.p+"assets/img/漏洞.2a3478e4.png"},515:function(t,_,v){t.exports=v.p+"assets/img/如何生成支付订单.fc9c4bd9.png"},516:function(t,_,v){t.exports=v.p+"assets/img/小程序支付.c9bf89ef.png"},556:function(t,_,v){"use strict";v.r(_);var a=v(4),i=Object(a.a)({},(function(){var t=this,_=t.$createElement,a=t._self._c||_;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#介绍"}},[t._v("#")]),t._v(" 介绍")]),t._v(" "),a("p",[t._v("站在支付新风口下，支付新模式必然出现，尤其是新零售时代，支付模式变革大势所趋，出现了线上和线下完全不同的支付模式。做商业项目必然要具备支付模块，而且随着新零售的普及，支付的方式也越来越多样。以下为神思者老师关于支付的详细文档，基于今晚所听及文档我自行梳理下。")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://www.showdoc.cc/817563107857167?page_id=4479841858638353",target:"_blank",rel:"noopener noreferrer"}},[t._v("新零售支付全家桶"),a("OutboundLink")],1)]),t._v(" "),a("hr"),t._v(" "),a("h2",{attrs:{id:"支付模块的漏洞"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#支付模块的漏洞"}},[t._v("#")]),t._v(" 支付模块的漏洞")]),t._v(" "),a("img",{staticStyle:{display:"inline-block",margin:"0 auto"},attrs:{src:v(514),width:"400px"}}),t._v(" "),a("ul",[a("li",[t._v("提防伪造支付状态请求\n"),a("ul",[a("li",[t._v("当没有数字签名时，我们可利用postman向服务器发送虚假信息，返回支付成功的状态。而服务器并不知道来源虚假，就有可能将未支付变为已支付")])])]),t._v(" "),a("li",[t._v("数字签名\n"),a("ul",[a("li",[t._v('相当于网站的"身份证"，让我们识别是否第三方支付平台的请求')]),t._v(" "),a("li",[t._v("关于相关知识点可参考"),a("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/43789231",target:"_blank",rel:"noopener noreferrer"}},[t._v("彻底搞懂HTTPS的加密机制"),a("OutboundLink")],1)])])])]),t._v(" "),a("h2",{attrs:{id:"支付应用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#支付应用"}},[t._v("#")]),t._v(" 支付应用")]),t._v(" "),a("ul",[a("li",[t._v("可以用在各种商业项目中")]),t._v(" "),a("li",[t._v("电商网站、视频网站、直播平台、线下零售、在线教育")]),t._v(" "),a("li",[t._v("涉及折扣、优惠券、团购、退款、融合支付等，并不简单")])]),t._v(" "),a("h2",{attrs:{id:"个人开发者使用支付"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#个人开发者使用支付"}},[t._v("#")]),t._v(" 个人开发者使用支付")]),t._v(" "),a("ul",[a("li",[t._v("目前主流支付为微信、支付宝、银联")]),t._v(" "),a("li",[t._v("微信不支持，必需为企业类型；支付宝、银联提供沙箱环境")]),t._v(" "),a("li",[t._v("使用微信支付的企业需认证，提供组织机构，注册金等")])]),t._v(" "),a("h2",{attrs:{id:"支付流程逻辑"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#支付流程逻辑"}},[t._v("#")]),t._v(" 支付流程逻辑")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("这里简单的以微信支付为例子说明下")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("创建支付订单")]),t._v(" "),a("img",{staticStyle:{display:"inline-block",margin:"0 auto"},attrs:{src:v(515),width:"400px"}}),t._v(" "),a("ul",[a("li",[t._v("小程序端发起支付请求")]),t._v(" "),a("li",[t._v("商户系统接收请求开始处理")]),t._v(" "),a("li",[t._v("判断用户是否存在")]),t._v(" "),a("li",[t._v("判断订单是否存在")]),t._v(" "),a("li",[t._v("判断代金券是否有效")]),t._v(" "),a("li",[t._v("判断团购是否过期")]),t._v(" "),a("li",[t._v("各种业务逻辑。。。")]),t._v(" "),a("li",[t._v("根据订单ID拿到订单详情")]),t._v(" "),a("li",[t._v("创建支付对象")]),t._v(" "),a("li",[t._v("向微信平台发送生成支付订单的请求")]),t._v(" "),a("li",[t._v("微信平台会根据订单信息核实后创建支付订单并返回")]),t._v(" "),a("li",[t._v("商户系统得到订单后生成数字签名，并返回支付参数到小程序端")])])]),t._v(" "),a("li",[a("p",[t._v("用户付款")]),t._v(" "),a("img",{staticStyle:{display:"inline-block",margin:"0 auto"},attrs:{src:v(516),width:"400px"}}),t._v(" "),a("ul",[a("li",[t._v("小程序端拿到支付参数，调用微信平台接口")]),t._v(" "),a("li",[t._v("成功则会拉起支付窗口")]),t._v(" "),a("li",[t._v("用户确认支付")]),t._v(" "),a("li",[t._v("微信平台会把支付结果返给商户系统和小程序端")])])])])]),t._v(" "),a("li",[a("p",[t._v("以上支付流程其实是被动发生的，也可以说是在正常条件下触发的。徜若某方面故障，像网络问题，技术故障等原因导致无法收到支付结果，所以主动查询是必要的保障。举个例子，小程序返回a订单支付成功消息后，通知商户系统，商户系统再通过a订单的订单ID向微信平台确认是否已经成功支付来修改订单状态")])]),t._v(" "),a("li",[a("p",[t._v("其它支付及关键点可参考"),a("a",{attrs:{href:"https://www.showdoc.cc/817563107857167?page_id=4479841858638353",target:"_blank",rel:"noopener noreferrer"}},[t._v("神思者老师的文档"),a("OutboundLink")],1)])])]),t._v(" "),a("h2",{attrs:{id:"总结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[t._v("#")]),t._v(" 总结")]),t._v(" "),a("ul",[a("li",[t._v("支付真的是门大学问，毕竟涉及到money")]),t._v(" "),a("li",[t._v("此次公开课加深了我对通用支付的理解")]),t._v(" "),a("li",[t._v("一句话，以安全支付为本！")])])])}),[],!1,null,null,null);_.default=i.exports}}]);